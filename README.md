# RabbitMQ Test Client

Тестовое Windows-приложение на C# для проверки механизма обмена сообщениями через RabbitMQ. Клиент отправляет запросы в очередь `request_queue`, получает ответы от сервера и декодирует данные прогнозов солнечной активности.

## Описание

Это тестовое приложение демонстрирует взаимодействие клиента с сервером через RabbitMQ. Оно:
- Отправляет запросы в очередь `request_queue`.
- Получает ответы от сервера в персональную очередь `response_queue_<client_name>`.
- Отображает данные ответа (время, размер, статус) в интерфейсе.
- Декодирует base64-кодированные XML-данные, отображая прогнозы солнечной активности (CME, FLR, GST) с фильтрацией по пороговым значениям.

Проект является прототипом для проверки механизма RabbitMQ. Реальная клиентская реализация планируется как мобильное приложение на Flutter в отдельном репозитории.

Связанные проекты:
- Сервер: [Python Interpretation Server](https://github.com/VladPomian/ServerPythonInterpretation)
- Python-скрипт для прогнозов: [Solar Activity Forecasting](https://github.com/VladPomian/prediction_script)

## Требования

- .NET 6.0 SDK
- RabbitMQ сервер
- Windows (для работы Windows Forms)
- Git

## Установка

### Зависимости

Убедитесь, что у вас установлены следующие компоненты:
- [.NET 6.0 SDK](https://dotnet.microsoft.com/download/dotnet/6.0)
- [RabbitMQ](https://www.rabbitmq.com/download.html)

Установите зависимости проекта:

```bash
dotnet restore
```

### Установка проекта

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/VladPomian/RabbitMQTestClient.git
   cd RabbitMQTestClient
   ```

2. Настройте конфигурацию:
   - В файле `Form1.cs` укажите параметры подключения к RabbitMQ (хост, порт, имя пользователя, пароль) или настройте их в `App.config`.

3. Убедитесь, что сервер [Python Interpretation Server](https://github.com/VladPomian/ServerPythonInterpretation) запущен и настроен для обработки запросов в очереди `request_queue`.

## Использование

1. Скомпилируйте и запустите проект:
   ```bash
   dotnet run
   ```

2. В открывшемся окне нажмите кнопку **Запрос** для отправки сообщения в очередь `request_queue`.

3. Сервер вернет ответ, содержащий:
   - Время записи (`time_enter`).
   - Base64-кодированные данные (`data`).
   - Размер данных (`size_data`).
   - Статус (`status`).

4. Ответ отображается в интерфейсе, а декодированные данные (при наличии значимых прогнозов CME, FLR, GST) показываются в сообщении.

## Структура проекта

- **Program.cs**: Точка входа приложения, инициализация Windows Forms.
- **Form1.cs**: Основная форма, содержащая логику взаимодействия с RabbitMQ и обработки ответов.
- **Form1.Designer.cs**: Автогенерируемый код для интерфейса Windows Forms.
- **Decoder.cs**: Декодирует base64-кодированные XML-данные и фильтрует прогнозы по пороговым значениям (CME ≥ 730, FLR ≥ 5.3, GST ≥ 7.2).
- **App.config**: Конфигурация клиента (имя клиента, параметры RabbitMQ).

## Пример вывода

При нажатии кнопки **Запрос** клиент отправляет сообщение в очередь `request_queue`. Ответ сервера отображается в интерфейсе, например:
```
Ответ от сервера:
Время: 2025-10-24 12:00:00
Размер: 1234
Статус: Success
```

Декодированные данные (при наличии значимых прогнозов) отображаются в сообщении:
```
Decoded XML:
Category: CME
Date: 2025-10-25, Value: 750.123
Category: FLR
Date: 2025-10-25, Value: 6.789
```

Если данные содержат ошибку:
```
Decoded Error Message: Ошибка: <описание_ошибки>
```

## Обработка ошибок

- Ошибки подключения к RabbitMQ или отправки запросов отображаются в виде сообщений.
- Некорректные base64-данные или XML вызывают сообщение об ошибке.
- Клиент предотвращает одновременную обработку нескольких ответов с помощью флага `isProcessingResponse`.

## Ограничения

- Это тестовое приложение для демонстрации работы RabbitMQ. Реальная клиентская реализация планируется как мобильное приложение на Flutter.
- Требуется запущенный сервер [Python Interpretation Server](https://github.com/VladPomian/ServerPythonInterpretation) и Python-скрипт [Solar Activity Forecasting](https://github.com/VladPomian/prediction_script).
- Работает только на Windows из-за использования Windows Forms.


## Контакты

Если у вас есть вопросы или предложения, создайте issue в репозитории или свяжитесь с автором: VladPomian.
